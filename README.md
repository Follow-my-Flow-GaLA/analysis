# Follow My Flow: Unveiling Client-Side Prototype Pollution Gadgets from One Million Real-World Websites

In this paper, we design a dynamic analysis framework, called GaLA (<u>Ga</u>dget <u>L</u>ocator and <u>A</u>nalyzer)
, to automatically detect client-side prototype pollution gadgets among real-world websites, and implement an open-source version of GaLA. Our key insight is to borrow existing defined values on non-vulnerable websites to victim ones where such values are undefined, thus guiding the property injection to flow to the sinks in gadgets. 

## System Design Overview

![Figure 1](./pic/gadget-sys-arch-2.pdf)

*System Architecture of GALA. There are three major phases: (i) Locating undefined properties, (ii) Assigning defined values, and (iii) Guiding dataflows for originally undefined properties. In Phase 1, GALA runs an instrumented JS runtime to output all the undefined properties; in Phase 2, GALA finds corresponding defined values in other executions (which could exist in the same or a different website) and assigns such values to undefined ones in Phase 1; in Phase 3, GALA uses these defined values to guide the execution with previously undefined values to reach the sink and discover gadgets. All the gadgets are validated automatically using a generated payload to ensure corresponding consequences are achieved.*


## Artifacts Overview

The artifacts in this repo comprise two main components: the adapted taint engine based on Chromium V8, and Python codes to analyze the log files generated by the modified engine. 

### Adapted Taint Engine

The source codes are under `./sanchecker/src`, adapted from prior taint engines [Melicher et al.]([URL](https://github.com/wrmelicher/ChromiumTaintTracking)) and [ProbetheProto]([URL](https://github.com/zifeng-kang/ProbetheProto)). 

*Detailed instructions coming soon!*

### Log Analysis

*Detailed instructions coming soon!*
